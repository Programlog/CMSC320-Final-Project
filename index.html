<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fall 2024 Final Data Science Project</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            line-height: 1.6;
            margin: 20px;
            background-color: #f9f9f9;
            color: #333;
        }

        h1,
        h2,
        h3 {
            color: #333;
        }

        header {
            background: #4CAF50;
            color: white;
            padding: 10px 15px;
            border-radius: 8px;
        }

        code {
            background: #f4f4f4;
            padding: 2px 4px;
            border-radius: 4px;
        }

        pre {
            background: #f4f4f4;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
            white-space: pre-wrap;
            word-wrap: break-word;
        }

        .section {
            margin-bottom: 30px;
            padding: 15px;
            background: white;
            border-radius: 8px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
        }

        ul {
            padding-left: 20px;
        }

        li {
            margin-bottom: 10px;
        }
    </style>
</head>

<body>
    <header>
        <h1>Unveiling Stocks: A Data Science Exploration of Apple</h1>
        <h2>Fall 2024 Data Science Project</h2>
        <p>All Contributions by Varun Kota</p>
    </header>

    <section class="section" id="introduction">
        <h2>Introduction</h2>
        <p>My project delves into Apple Inc. (AAPL) stock data, offering a comprehensive, data-driven analysis of its performance over time. My goal is to uncover key insights into stock price behaviors, correlations, and market trends, leveraging statistical and machine learning techniques. These findings are designed to help readers to make better informed decisions, not just about Apple stock, but also about other stocks with similar characteristics, such as Amazon and other tech giants.<p>
    <p>
        At the heart of this analysis are two key research questions among others:
    </p>
    <ul>
        <li>
            How do key metrics such as opening price, closing price, and trading volume correlate with each other, and what do these correlations reveal about Apple’s stock behavior over time?
        </li>
        <li>
            Can machine learning models like LSTMs accurately predict Apple’s stock price based on historical data? If so, what are the limitations of such models in capturing stock price variance?
        </li>
    </ul>


<p>Whether you're a beginner in investing or have more experience, my aim is to make complex stock data approachable and actionable. As a relatively new investor myself, I understand how daunting the stock market can seem. Breaking it down piece by piece can truly make a difference. By combining data exploration, statistical analysis, and machine learning, I hope to not only present some important trends in Apple’s stock but also inspire you to be comfortable to using technology and modern tools to help you invest with greater confidence! </p>
    </section>

    <section class="section" id="data-curation">
        <h2>Data Curation</h2>
        <p>The data for this analysis was sourced from publicly available historical stock data for Apple Inc. (AAPL) on Kaggle Apple Stock Price from 1980-2021 by Meet Nagadia. 
            The dataset is verified and comprehensive, with records over 40 years of extensive data, allowing for robust trend analysis over 
            different economic cycles and major market events. This depth of historical data helps to ensure that our conclusions 
            and predictions are grounded in significant evidence and not influenced by short term noise.</p>
        <a href="https://www.kaggle.com/datasets/meetnagadia/apple-stock-price-from-19802021/data/">Kaggle Dataset</a>
        <a href="https://colab.research.google.com/drive/17E3oGQ1A15vTnINKlFuGnCHRhbGoPjjN?usp=sharing"> Colab Notebook</a>
        <h3>Imports</h3>
        <pre><code>import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
from scipy import stats
import numpy as np
from sklearn.preprocessing import MinMaxScaler
from tensorflow.keras.models import Sequential
from tensorflow.keras.layers import Dense, LSTM</code></pre>
<p><strong>Loading and Preprocessing Data</strong><p>
<pre><code>df = pd.read_csv('AAPL.csv')</code></pre>
<p>Load the dataset downloaded from Kaggle into a Pandas dataframe</p>
        <p>Next preprocessing steps include:</p>
        <ul>
            <li><strong>Converting Dates:</strong> Dates were converted to standard datetime objects to enable effective analysis and ensure accurate plotting and resampling.</li>
            <li><strong>Ensuring Data Integrity:</strong> We checked for and handled missing values, ensuring no gaps in the data. Data quality is crucial for the reliability of any analysis, and missing values could lead to inaccurate insights.</li>
        </ul>
        <pre><code>df['Date'] = pd.to_datetime(df['Date'])
print(df.isnull().sum())  # all zeroes, no missing values!</code></pre>
<p>We are also going to need a new column for the change in stock price day by day known as Daily Return, which will be very useful for seeing the growth prospects of Apple. This can be derived by taking a rolling difference of Adj Close price.</p>
        <pre><code>df['Daily Return'] = df['Adj Close'].pct_change() #% diff adj close (previous row and current row by default) </code></pre>

    </section>

   <section class="section" id="analysis">
    <h2>Exploratory Analysis</h2>

    <h3>Graphical Analysis</h3>
<p>Plot distribution of Adjusted Close Prices, an important statistic.
<pre><code>plt.hist(df['Adj Close'], bins=50, edgecolor='black')
plt.title('Distribution of Adjusted Close Prices')
plt.xlabel('Adjusted Close Price')
plt.ylabel('Frequency')
plt.grid(True)
plt.show()</code></pre>
<img src="adjclose.png" alt="adj close price graph">
<p>        This histogram shows the distribution of Apple’s adjusted close prices over time. Most of the stock prices are 
        concentrated in the lower range between $0 and $25, with the frequency dropping off as prices increase. 
        This indicates that Apple’s stock price was much lower for most of the dataset's time period, with only a few occurrences 
        of higher prices. 
    </p>
    <p>
        The skewed nature of the distribution suggests a historical growth pattern where the stock started at lower prices 
        and gradually increased over time. This graph highlights Apple’s trajectory as a growth stock, confirming its significant price appreciation over the years. Factors such as Apple’s stock splits and adjustments for dividends contribute to 
        the clustering of lower prices, as these events reduce the stock price but don't change the overall value of Apple.
        For long term investors, this visualization underscores the value of early investments in Apple, showcasing how much the stock has grown over its history and how recently it rose to current heights.
    </p>
    <p><strong>Correlations Between Stock Metrics</strong></p>
<pre><code>corr = df[['Open', 'High', 'Low', 'Close', 'Adj Close', 'Volume']].corr()
sns.heatmap(corr, annot=True, cmap='coolwarm', linewidths=0.5)
plt.title('Correlation Heatmap of Stock features')
plt.show()</code></pre>
            <img src="image3.png" alt="correlations between stock metrics as heatmap" width="400" height="350">
 <p>This heatmap shows the correlations between key stock metrics (Open, High, Low, Close, Volume), providing an intuitive visual representation of how these variables move in relation to one another. For instance, high correlations between opening and closing prices provide evidence of the intraday trend consistency. This consistency can be expected, given that stocks tend to exhibit similar behavior throughout a single trading day, driven by broader market sentiment and investor behavior.</p> <p>On the other hand, trading volume exhibits a weak negative correlation (shown in blue) with these price metrics, indicating that price movements are not strongly influenced by trading volume, though a slight inverse relationship may exist. This suggests that while volume can spike during major market events, it is not a reliable predictor of price changes on its own.</p>

<p><strong>Time series graph of daily returns and outliers</strong></p>
<pre><code>daily_return_cleaned = df['Daily Return'].dropna().reset_index(drop=True)
z_scores = stats.zscore(daily_return_cleaned)

outliers = daily_return_cleaned[abs(z_scores) > 3] # data points with a z score greater than +- 3 can be considered outlier

plt.figure(figsize=(10, 6))
plt.plot(df['Date'][1:].reset_index(drop=True), daily_return_cleaned, label='Daily Returns')
plt.scatter(df['Date'][1:].reset_index(drop=True)[abs(z_scores) > 3], outliers, color='red', label='Outliers')
plt.title('Daily Returns with Outliers Highlighted')
plt.xlabel('Date')
plt.ylabel('Daily Return')
plt.legend()
plt.grid(True)
plt.show()

len(outliers) / len(daily_return_cleaned) # 0.012611 approx 1.26%</code></pre>
            <img src="image2.png" alt="daily returns" width="500" height="325">

<p> This time series plot of Apple’s daily stock returns, with significant outliers (discovered with z-score) marked in red. These outliers represent extreme deviations from the norm, often associated with major market events such as the dot-com bubble burst in 2000, the 2008 financial crisis, and recently the COVID-19 pandemic in 2020. The majority of daily returns cluster around zero, demonstrating the relative stability of Apple’s stock over time. Observing the peaks and valleys in daily returns can help identify both opportunities for buying low and selling high. These are great opportunities to make money, but its also easy to lose money. Understanding these outliers can help you as investors anticipate potential risks and opportunities tied to economic news or company specific news.</p>

    <h3>Statistical Analysis</h3>
    <p>
        <strong>Statistical Test on Daily Returns:</strong>  
        We conducted a one-sample t-test to determine whether the mean daily return is significantly different from zero. This analysis helps assess whether, over time, 
        the stock's returns tend to be consistently positive or negative, a fundamental indicator for long-term investors.
    </p>
    <p>
        <strong>Hypotheses:</strong>
    </p>
    <ul>
        <li><strong>H<sub>0</sub>:</strong> μ = 0 (Mean daily return is equal to zero.)</li>
        <li><strong>H<sub>a</sub>:</strong> μ ≠ 0 (Mean daily return is not equal to zero.)</li>
    </ul>
    <pre><code>_, p_value = stats.ttest_1samp(df['Daily Return'], 0)
p_value # 0.0036 < .05, reject H0</code></pre>

    <p>
        The results showed that the p-value was less than our alpha level of 0.05, leading us to reject the null hypothesis. This means that the mean daily return 
        is statistically significantly different from zero. Specifically, the positive returns suggest that Apple stockholders, on average, experience a profit each day. 
        This aligns with Apple's strong historical growth trajectory, supported by its technological leadership, loyal customer base, and consistent innovation.
    </p>
 </section>

    <section class="section" id="machine learning analysis">
        <h2>Machine Learning Analysis</h2>
        <body>
            <h3>1. Data Preparation</h1>
            <p>The adjusted closing price, which is the target variable for our prediction.</p>
            <pre><code>adj_close = df[['Adj Close']]</code></pre>
            <p><strong>Preprocessing Data:</strong></p>
            <pre><code>scaler = MinMaxScaler(feature_range=(0, 1))
scaled_data = scaler.fit_transform(adj_close)</code></pre>
            <p>The fit_transform method is used to fit the scaler to the adj_close data and then transform it to the scaled values.</p>
            <pre><code>train_data_len = int(np.ceil(len(scaled_data) * 0.8))
                train_data = scaled_data[0:train_data_len, :] </code></pre>
            <p>Calculates and selects the first 80% of the scaled data (adj. close) for training.</p>
            <h3>2. Creating Training Data</h2>
            <pre><code>X_train = []
y_train = []</code></pre>
            <p><strong>X_train, y_train</strong> lists will store the input features and target values for the training data, respectively.</p>
            <pre><code>for i in range(60, len(train_data)):
        X_train.append(train_data[i-60:i, 0])
        y_train.append(train_data[i, 0])</code></pre>
            <p>The for loop iterates through the training data, creating data points for the model:</p>
            <ul>
                <li><strong>X_train</strong> holds the previous 60 days adjusted closing prices, essentially using a 60 day window as input to the LSTM model.</li>
                <li><strong>y_train</strong> holds the adjusted closing price of the current day, which is the value the model will try to predict.</li>
            </ul>
            <pre><code>X_train, y_train = np.array(X_train), np.array(y_train)
X_train = np.reshape(X_train, (X_train.shape[0], X_train.shape[1], 1))</code></pre>
            <p>The <code>X_train</code> and <code>y_train</code> lists are then converted into NumPy arrays. <code>X_train</code> is reshaped to a 3D array because it will be fed into the LSTM model (samples, timesteps, features).</p>
            <h3>3. Building and Training the Model</h2>
            <pre><code>model = Sequential()
model.add(LSTM(units=50, return_sequences=True, input_shape=(X_train.shape[1], 1)))
model.add(LSTM(units=50, return_sequences=False))
model.add(Dense(units=25))
model.add(Dense(units=1))</code></pre>
            <p>Here, we create a keras model and add two LSTM layers to the model, with 50 units each. I chose LSTMs here because they work well with sequential data like time series such as this one.</p>
            <pre><code>model.compile(optimizer='adam', loss='mean_squared_error')</code></pre>
            <p>Make the model for training using the very popular and versatile Adam optimizer and mean squared error as the loss function we learned in class.</p>
            <pre><code>model.fit(X_train, y_train, batch_size=1, epochs=3)</code></pre>
            <p>Trains the model on the training data (<code>X_train</code>, <code>y_train</code>) for 3 epochs. The number of epochs is pretty arbitrary. I chose 3 epochs as it is a balance of accuracy and compute efficiency without overly underfitting or overfitting. With more time, I would fine tune this. On the other hand, batch size is more particular. I chose a batch size of 1 because time series data can change dramatically. Specifically, Apple stock price can have sudden movements based on earnings or company news. Smaller batch sizes allow this model to adapt more quickly to new information. Again, more fine tuning can be done here.</p>

            <h3>4. Testing</h2>
            <pre><code>test_data = scaled_data[train_data_len - 60:, :] </code></pre>
            <p><strong>Testing Split:</strong> Gets the data after the training set for testing.</p>
            <pre><code>X_test = []
y_test = adj_close[train_data_len:].values</code></pre>
            <p><strong>X_test, y_test:</strong> These lists will hold the input features and adj close series for the testing data, respectively.</p>
            <pre><code>for i in range(60, len(test_data)):
    X_test.append(test_data[i-60:i, 0])
    
    X_test = np.array(X_test)
    X_test = np.reshape(X_test, (X_test.shape[0], X_test.shape[1], 1))
</code></pre>
            <p>Similar to what we did in the above sections, just for testing.</p>
            <pre><code>predictions = model.predict(X_test)
predictions = scaler.inverse_transform(predictions)</code></pre>
            <p><strong>predictions:</strong> We use our trained LSTM model to make predictions on the test data. The output is the predicted adjusted closing prices, but they are still in the scaled range (0 to 1). To get the actual predictions back in the original scale, the inverse_transform is applied.</p>

            <h3>5. Visualization</h2>
            <img src="modelprediction2.png" alt="stock price predictions" width="500" height="325">
              <p>Finally, let's see the results. Our model is trained on the Apple stock data to predict future Apple stock prices. This visualization of the testing set results, shows the actual stock price over time, alongside our model's predictions. Looking at the graph, it looks like our model was pretty sucessful! When the stock variance was lower, it appears our model peformed better but as it increased, our model consistenyl undershot the actual price. Some potential causes of this could be the fact our model is trained on data from 1980-2014. Not only is the stock market a very different place it was 10-40 years, but also Apple's price was also much lower. This might have been partially solved by the minmaxscaler but perhaps an alternative scaler would be better suited. It would require more testing and finetuning.
    <p>However, the prediction still captured much of the trends pretty accurately. This could be a useful first tool for newbie investors to use to make informed investment decisions.</p>
        </body>
    </section>

    <section class="section" id="visualizations">
        <h2>More Visualizations</h2>
        <p>Visualizations provide a deeper understanding of the stock's performance over time and the relationships between different metrics:</p>
        <ul>
            <li><strong> Historical Performance of Apple Stock:</strong> The long-term performance chart of Apple stock reveals the broader growth trends and the impact of major market crashes, 
                such as the 2008 financial crisis or the more recent COVID-19 pandemic. These trends help in understanding Apple's resilience and its recovery trajectory following economic downturns. Zooming out, Apple's stock price growth appears to be exponential.</li>
            <img src="image1.png" alt="impact of market crashes on stock behavior" width="500" height="400">
        </ul>
    </section>


    <section class="section" id="insights">
        <h2>Insights & Conclusions</h2>
        <ul>
            <li><strong>Interconnected Stock Metrics:</strong> The high correlation among stock prices (Open, High, Low, Close) reflects the interconnected nature of daily trading dynamics. 
                This suggests that investors can use one price metric to make inferences about others, which can simplify analysis when making decisions.</li>
            <li><strong>Long-term Growth Potential:</strong> The finding that daily returns are significantly different from zero implies that Apple’s stock generally follows an upward trajectory 
                over time. Investors who hold Apple stock for the long term are more likely to experience consistent positive returns, which is supported by the company's growth history and market leadership.</li>
            <li><strong>Impact of External Events:</strong> High-volume trading days often coincide with significant external events, such as new product announcements or macroeconomic news. 
                Understanding these patterns can help investors anticipate potential price movements during such events and develop better trading strategies based on context-driven analysis.</li>
            <li><strong>Machine Learning Predictions</strong>Using LSTM based models, I was able to pretty acurately predict stock price. Due to the LSTM handling time series data well and Adj. close and time have a strong correlation from which the model can learn. Machine learning is a really useful tool to help understand stocks price movement in the past and also make predictions into the future. However, be cautious as ML models can't really predict the future. When it comes to the stock market, its guess may be as good as yours :) </li>
        </ul>
        <p>Overall, this analysis provides actionable insights into the behavior of Apple’s stock over time, supported by statistical evidence and exploratory trends. Whether you're an investor 
            looking to make more informed decisions or a student of financial markets, understanding these patterns is crucial. Hopefully, this analysis has given you a better insight into Apple stock, 
            which can help you make well informed investment decisions in the future.</p>
    </section>
    
    <section class="section" id="additional-resources">
    <h2>Additional Resources!</h2>
    <div>
        <h3>For Beginners</h3>
        <ul>
            <li><a href="https://www.investopedia.com/investing/investing-101-how-to-invest-in-stocks/" target="_blank">Stock Market Basics</a></li>
            <li><a href="https://realpython.com/python-basics/" target="_blank">Introductory Python Tutorials</a></li>
            <li><a href="https://investologyhub.com/understanding-stock-correlation">Stock Price Correlation Guide</a></li>
        </ul>
    </div>
    <div>
        <h3>For Advanced Readers</h3>
        <ul>
            <li><a href="https://www.coursera.org/learn/nlp-sequence-models" target="_blank">Deep Learning with LSTM</a></li>
            <li><a href="https://scikit-learn.org/stable/modules/preprocessing.html" target="_blank">Advanced Data Preprocessing</a></li>
            <li><a href="https://quant.stackexchange.com/" target="_blank">Quantitative Finance</a></li>
        </ul>
    </div>
</section>

</body>

</html>
